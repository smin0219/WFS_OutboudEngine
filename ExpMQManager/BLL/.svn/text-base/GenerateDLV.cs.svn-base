using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using ExpMQManager.DAL;
using ExpMQManager.Data;

namespace ExpMQManager.BLL
{
    public class GenerateDLV : GenerateBase
    {
        public override string doBuildUp(string msgType, string subType, int mid, int flightSeq, int queueId)
        {
            DlvEntity dlvEntity = new DlvDAC().GetDLVInfoDAC(mid, flightSeq, msgType, subType, queueId);
            return buildUpDLV(dlvEntity, msgType, subType);
        }

        public string buildUpDLV(DlvEntity msgEntity, string msgType, string subType)
        {
            string strAWB = "";

            strAWB = base.buildUpBase(msgEntity, msgType, subType);

            string dlvTime = msgEntity.dlvTime.ToString("dd") + transMonth(msgEntity.dlvTime.ToString("MM")) +
                            msgEntity.dlvTime.ToString("HH") + msgEntity.dlvTime.ToString("mm");
            string weightFormatted = string.Format("{0:0.0}", msgEntity.weight);
            char shipmentCode = replaceShipmentIndicator(msgEntity.shipmentIndicator[0]);
            string cnee = truncateString(msgEntity.cnee, 35);


            strAWB += subType.ToUpper() + "/" + dlvTime + "/" + msgEntity.destFlight + "/" + shipmentCode +
                        msgEntity.pcs + "K" + weightFormatted + "/" + cnee.ToUpper() + "\r\n";

            return strAWB;
        }

    }
}
